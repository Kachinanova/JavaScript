<!DOCTYPE html>
<html lang="en">

<head>
<!-- WhosIts and WhatsIts
Author: Katrina Ward
Date: 11/29/2017 -->


<title>WhotsIts and WhatsIts</title>
<meta charset="utf-8">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="whositsandwhatsits.css">

<link rel="stylesheet" href="shCore.css">
<link rel="stylesheet" href="shThemeDefault.css">


<!--
<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
-->


<!-- [if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js">
</script>
<![endif]-->
</head>

<body>
	<div id="wrapper">
		<header>
			<a href="index.html"><h1>WhosIts and WhatsIts</h1></a>
		</header>

<!-- Navigation links in an unordered list. -->
		<nav>
			<ul>
				<li><a id="curpage" href="index.html">&nbsp; HOME &nbsp;</a></li>
				<li><a href="hobbies.html"> &nbsp; HOBBIES &nbsp;</a></li>
				<li><a href="bucket.html"> &nbsp; BUCKET LIST &nbsp;</a></li>
				<li><a href="contact.html"> &nbsp; CONTACT &nbsp;</a></li>
				<li><a href="archive.html"> &nbsp; ARCHIVES &nbsp;</a></li>
			</ul>
		</nav>

		<main>

			<h1>Broken Down Code with Comments</h1>
			
			<p>Below I walk you through the code, breaking it down into managable chuncks. This is a good way to learn what each bit of code actually does.
			</p>
			
			<div class="jumpnav">
				<p>Tutorial Mode: <a href="tutorial.html">With Comments</a> - <a href="fulltutorial.html">Without Comments</a></p>
			
				<p>Jump to: <a href="#html">HTML</a> - <a href="#css">CSS</a> - <a href="#js">JAVASCRIPT</a></p>
			</div>
			
			<br>
			<hr>
			<br>
			
			<h2><a name="html">The HTML</a></h2>
			
			<p>The first thing you want to do is create the html to contain the time calculator. When you pick a date, the time elapse or remaining will display within an empty paragraph tag. This tag can be placed anywhere on the page so make it fit your layout. Be sure to include an id to allow for formatting with CSS and data input through JS later on.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				<p id="elapTime"></p>
			]]></script><br>
			
			<p>Next, you'll create the label and input for the date. Because different browsers display differently, it is advised to use a table calendar and text input rather than a date type input. Place this where ever you'd the input box to be.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				<label for="pickDate">Pick a date</label>
				<input id="pickDate" type="text">
			]]></script><br>

			<p>Right after the input box you'll want to code your table calendar. You will see this table until you complete the CSS to hide it. Then you will use JavaScript to call it when the user clicks in the text box. The code looks a little confusing but is really simple once broken down.
			</p>
			
			<p>Create a div with an id (I used "cal") to contain your table. This will be referenced later to hide the table until called. Inside the first div, create another div with id containing the “previous” text, allowing users to go back a month. Below the previous div, but inside the first, create another div with id containing the “next” text, allowing the calendar to move forward a month.
			</p>
				
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				<div id="cal">
					<div id="prev">&lt; previous</div>
					<div id="next">next &gt;</div>
			]]></script><br>
			
			<p>Create a table with id. Inside the table, create an empty caption with id. This, along with the rest of the table, will be populated with JS.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				<table id="calBody">
					<caption></caption>
			]]></script><br>
			
			<p>Inside the table, you’re going to create a cell row using the tr tag. Inside the this first row you’ll make 7 empty header cells using the th tag. Inside each of these put the day of the week, starting with Sun.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				<tr>
				   <th>Sun</th>
				   <th>Mon</th>
				   <th>Tue</th>
				   <th>Wed</th>
				   <th>Thu</th>
				   <th>Fri</th>
				   <th>Sat</th>
				</tr>
			]]></script><br>
			
			<p>Underneath the first table row (under the closing tr tag), you'll create another table row. Make 7 empty table cells using the td tag. Repeat step 7 four more times. You should have 5 rows with 7 cells in each. This does not include the row with headers.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				<tr>
				   <td></td>
				   <td></td>
				   <td></td>
				   <td></td>
				   <td></td>
				   <td></td>
				   <td></td>
				</tr>
			]]></script><br>
			
			<p>After the closing table tag, and before the last ending div tag, create a paragraph with id. Inside this paragraph write “close”.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
					<p id="close">close <span>&#9746;</span></p>
				</div>
			]]></script>
			
			<br>
			<hr>
			<br>
			
			<div class="jumpnav">
				<p>Jump to: <a href="#html">HTML</a> - <a href="#css">CSS</a> - <a href="#js">JAVASCRIPT</a></p>
			</div>
			
			<br>
			<hr>
			<br>
			
			
			
			
			<h2><a name="css">The CSS</a></h2>
			
			
			
			<p>And that's it for the HTML portion of this tutorial. Next, we'll be creating the CSS to style and hide the calendar until clicked. The code below targets the div with the id “cal” and tells it what size it should be, the amount of spacing it should have, and then centers it. It also hides the calendar with the display: none attribute. 
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				div#cal	{
					display: none;
					width: 60%;
					height: 400px;
					margin: auto;
				}
			]]></script><br>
			
			<p>This next portion sets the “previous” text on the calendar to the left. And the “next” text to the right.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				div#prev	{
					float: left;
				}
		
				div#next	{
					float: right;
				}
			]]></script><br>
			
			<p>This targets the table tag with the “calBody” id. First, we need to clear the two floats above or the calendar won’t look right. Then we set the height and width to take up the entire div it’s contained within. We also center the table using the margin attribute.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				table#calBody	{
					clear: both;
					width: 100%;
					height: 100%;
					margin: auto;
				}
			]]></script><br>
			
			<p>Almost finished with the CSS, this targets the closing text and sets it in the bottom right corner of the “cal” div.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				p#close	{
					float: right;
				}
			]]></script>
			
			<br>
			<hr>
			<br>
			
			<div class="jumpnav">
				<p>Jump to: <a href="#html">HTML</a> - <a href="#css">CSS</a> - <a href="#js">JAVASCRIPT</a></p>
			</div>
			
			<br>
			<hr>
			<br>
			
			
			
			
			<h2><a name="js">The JavaScript</a></h2>
			
			
			
			<p>Here is where things get interesting.  Everything below here is what makes the calculator function. You could say this is the background code, the engine. We’re going to start by telling the browser to render the code in strict mode. Then we’ll declare our global variables. The variables are visible to all functions and can be called at any time. As you read, please remember the text in green is a comment I added to further explain certain lines.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
			"use strict";

			/* Global Variables */
			var dateObject = new Date();
			var countdown;
			]]></script><br>
			
			<p>Below that, we’re going to create a function to display and populate our calendar. Inside that function we will begin by creating our local variables. Local variables can only be used within the function holding them. The monthArray variable will be cycled through via the previous and next text button in the tables HTML. The thing to remember about arrays is the first option is always 0. In this case January would be zero while march would be two.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
			function displayCalendar(whichMonth)	{
				var date;
				var dateToday = new Date;
				var dayOfWeek;
				var daysInMonth;
				var dateCells;
				var captionValue;
				var month;
				var year;
				var monthArray = ["January", "February", "March", "April", "May",
						"June", "July", "August", "September", "October", "November",
						"December"];
			]]></script><br>
			
			<p>Now that the local variables are done, we need to make the previous and next buttons actually work. When you click the previous button, this code tells the function to go back by one in the monthArray above. Otherwise, it tells it to move forward by one if the next button is clicked.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				if (whichMonth === -1)	{
					dateObject.setMonth(dateObject.getMonth() - 1);
				} else if (whichMonth === 1)	{
					dateObject.setMonth(dateObject.getMonth() + 1);
				}
			]]></script><br>
			
			<p>We’ve already listed our local variables, now it’s time to set their values. The code below pulls the data from the user’s selections within the table. The last tine in this section will write the captionValue into the empty captions we wrote above. 
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				month = dateObject.getMonth();
				year = dateObject.getFullYear();
				dateObject.setDate(1);
				dayOfWeek = dateObject.getDay();
				captionValue = monthArray[month] + " " + year;
				document.querySelector("#cal table caption").innerHTML = captionValue;
			]]></script><br>
			
			<p>This next section is kind of large but it’s purpose is simple. It sets the number of days in each month to the appropriate count. All the months with 31 days are listed first by their number in the array. Remember that January is 0. The else if section sets up February with it’s unique numbers. If a leap year, it gets 29, if not it gets 28. Then follows the rest of the months set to 30 days.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[	
				if (month === 0 || month === 2 || month === 4 ||
					month === 6 || month === 7 || month === 9 ||
					month === 11)	{ // Jan, Mar, May, Jul, Aug, Oct, Dec
						daysInMonth = 31;
					} else if (month === 1) { // Feb
						if (year % 4 === 0)	{ // Leap year test
							if (year % 100 === 0)	{
								// Years ending in 00 are not a leap year unless
								// divisible by 400
								if (year % 400 === 0)	{
									daysInMonth = 29;
								} else	{
									daysInMonth = 28;
								}
							} else	{
								daysInMonth = 29;
							}
						} else	{
							daysInMonth = 28;
						}
					} else	{ // Apr, Jun, Sep, Nov
						daysInMonth = 30;
					}
			]]></script><br>
			
			<p>Our next task is to populate the table cells with the calendar dates. We are also going to clear the cells of any current content. This allows new numbers to be inserted when the month is changed.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[	
				dateCells = document.getElementsByTagName("td");
				for (var i = 0; i < dateCells.length; i++)	{
					// Clear existing table dates
					dateCells[i].innerHTML = "";
					dateCells[i].className = "";
				}
			]]></script><br>
			
			<p>We’re going to need to count through the cells as we go so we set the current number to the “I” variable. This allows the value to change as the function continues looping. Aside from populating the cells with the day number, it also applies either the “date” class or the “futuredate” class which you can chose to style in the CSS. I chose not to style them for this example. The final task in this segment is the display the calendar. It changes the CSS to display: block instead of none.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				for (var i = dayOfWeek; i < daysInMonth + dayOfWeek; i++)	{
					// Adds dates to day cells
					dateCells[i].innerHTML = dateObject.getDate();
					dateCells[i].className = "date";
					if (dateToday < dateObject)	{
						dateCells[i].className = "futuredate";
					}
					date = dateObject.getDate() + 1;
					dateObject.setDate(date);
				}

				dateObject.setMonth(dateObject.getMonth() - 1);
				// Reset month to month shown
				document.getElementById("cal").style.display = "block";
			}
			]]></script><br>
			
			<p>Here we will begin a new function to allow the user to select a date by clicking in the table and to store their selection. First we need to have the function execute when a page event happens (when clicked).
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				function selectDate(event)	{
					if (event === undefined)	{ // Get caller element in IE8
						event = window.event;
					}
			]]></script><br>
			
			<p>This next chunk keeps the calendar open if nothing is selected and also keeps the input box empty.  Now we need to gather the user’s current date. Having their current date allows the code to calculate has long has passed or how long until the date chosen by the user. The last thing to do in this function is to close the calendar table and to call the countdown function.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				var callerElement = event.target || event.srcElement;
					
				if (callerElement.innterHTML === "")	{
					// Cell contains no date, so don't close the calendar
					document.getElementById("cal").style.display = "block";
					return false;
				}
				
				dateObject.setDate(callerElement.innerHTML);
					
				var fullDateToday = new Date();
				var dateToday = Date.UTC(fullDateToday.getFullYear(),
					fullDateToday.getMonth(), fullDateToday.getDate());
				var selectedDate = Date.UTC(dateObject.getFullYear(),
					dateObject.getMonth(), dateObject.getDate());
					
				document.getElementById("pickDate").value =
						dateObject.toLocaleDateString();
			]]></script><br>
			
			<p>Once the function has done its job and the user has chosen a date, it’s time to close the calendar and update the countdown. This will be done with two separate functions, so we’ll add some code to run those functions at the end of the current one.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
					hideCalendar(); 
					// Executes the hideCalendar function
					updateCountdown();
					// Executes the updateCountdown function
				}
			]]></script><br>
			
			<p>Next, we need to create the function to hide the calendar. This is a simple one that changed the CSS back to none.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				/* Closes Calendar via button or after selection */
				function hideCalendar()	{
					document.getElementById("cal").style.display = "none";
				}
			]]></script><br>
			
			<p>These two functions below cycle backwards and forwards through the months as the user clicks previous and next.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				/* CLUSTER: Changes the month when prev or next is clicked */
				function prevMo()	{
					displayCalendar(-1);
				}
				
				function nextMo()	{
					displayCalendar(1);
				} // END CLUSTER
			]]></script><br>
			
			<p>Now it’s time to use the date selected above to populate the countdown. Our first job is to create the local variables to store the current date and the date chosen by the user. These will be used by the “if” and “else if” statements in the next two segments.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				/* Calculates the time since/until selected date */
				function updateCountdown()	{
					var dateToday = new Date();
					var dateFrom = Date.UTC(dateToday.getFullYear(),
							dateToday.getMonth(), dateToday.getDate())
					var dateTo = Date.UTC(dateObject.getFullYear(),
							dateObject.getMonth(), dateObject.getDate());
					var selectedDate = Date.UTC(dateObject.getFullYear(),
							dateObject.getMonth(), dateObject.getDate());
			]]></script><br>
			
			<p>Once the functions variables are defined, we need to create the first statement which will calculate the time until a future date. To do this we will start with the years, so we’re going to subtracts the future date from the current one, and then divide that number by the number of milliseconds in a year. You can see this behind done in the variable “yearsUntil.” Once the math is done, we need to write the results to the paragraph with the id “elapTime.”
			</p>
			
			<p>Note that any text you want written needs to be placed in quotes. To place a variable value inside direct text, you can concatenate by adding a + sign as shown below. Any spaces need to be placed inside the quotes as well. 
			</p>
			
			<p>We’re going to repeat the step above for the months and days, but this time we’re going to divide the years until by the number of milliseconds in a month and then in a day.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
					if (selectedDate >= dateToday)	{
							// Years
						var yearsUntil = Math.floor((dateTo - dateFrom) / 31556952000);
						document.getElementById("elapTime").innerHTML += "There are " + yearsUntil +" years, ";
						
							// Months
						var yearSeg = (dateTo - dateFrom) % 31556952000;
						var monthsUntil = Math.floor(yearSeg / 2629746000);
						document.getElementById("elapTime").innerHTML += monthsUntil + " months, and ";
						
							// Days
						var monthSeg = (yearSeg) % 2629746000;
						var daysUntil = Math.floor(monthSeg / 86400000);
						document.getElementById("elapTime").innerHTML += daysUntil + " days left.";
					}
			]]></script><br>
			
			<p>Directly after the above “if” statement, we need to add an “if else” to calculate the time passed form the time chosen. This will look almost identical to the last statement except instead of subtracting the chosen date from today, we’re going to subtract today from the chosen date. This will give us the time passed from a past date.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
					else if (selectedDate <= dateToday)	{
								// Years
						var yearsUntil = Math.floor((dateFrom - dateTo) / 31556952000);
						document.getElementById("elapTime").innerHTML += "It has been " + yearsUntil +" years, ";
						
							// Months
						var yearSeg = (dateFrom - dateTo) % 31556952000;
						var monthsUntil = Math.floor(yearSeg / 2629746000);
						document.getElementById("elapTime").innerHTML += monthsUntil + " months, and ";
						
							// Days
						var monthSeg = (yearSeg) % 2629746000;
						var daysUntil = Math.floor(monthSeg / 86400000);
						document.getElementById("elapTime").innerHTML += daysUntil + " days since.";
					}
				}
			]]></script><br>
			
			<p>In order for the functions above to work, they need to be called when a chosen event happens. Such as clicking a button. To make this happen we will create the event listeners to fire when their selected elements are clicked on. This is a three-step process for each desired event. First is a variable to identify the element we want the function to “listen” to. These elements are selected either by the assigned id or HTML tag type. The we create an “if” statement to fire when it’s clicked. This will cause it to call the desired function. This is followed by an “else if” statement that does the same thing for older browsers.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				/* Event Listeners */
				function createEventListeners()	{
					var dateField = document.getElementById("pickDate");
						// Opens the calendar when clicked
					if (dateField.addEventListener)	{
						dateField.addEventListener("click", displayCalendar, false);
					} else if (dateField.attachEvent)	{
						dateField.attachEvent("onclick", displayCalendar);
					}
			]]></script><br>
			
			<p>This next event listener is similar to the first, however it needs to be able to tell which cell in the calendar is clicked. To allow this we need to create a for statement to count the cells when clicked. Remember to add this for statement to both the if and the else if statements.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
					var dateCells = document.getElementsByTagName("td");
						// Selects date when clicked
					if (dateCells[0].addEventListener)	{
						for (var i = 0; i < dateCells.length; i++)	{
							dateCells[i].addEventListener("click", selectDate, false);
						}
					} else if (dateCells[0].attachEvent)	{
						for (var i = 0; i < dateCells.length; i++)	{
							dateCells[i].attachEvent("onclick", selectDate);
						}
					}
			]]></script><br>
			
			<p>There are still two more event listeners needed. One to listen for when the close button is clicked on one to listen to the previous and next buttons. Because the second is listening for two events, it will need two variables and instructions for both.
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
					var closeButton = document.getElementById("close");
						// Closes the calendar when clicked
					if (closeButton.addEventListener)	{
						closeButton.addEventListener("click", hideCalendar, false);
					} else if (closeButton.attachEvent)	{
						closeButton.attachEvent("onclick", hideCalendar);
					}
					
					var prevLink = document.getElementById("prev");
					var nextLink = document.getElementById("next");
						// Changes month when prev or next is clicked
					if (prevLink.addEventListener)	{
						prevLink.addEventListener("click", prevMo, false);
						nextLink.addEventListener("click", nextMo, false);
					} else if (prevLink.attachEvent)	{
						prevLink.attachEvent("onclick", prevMo);
						nextLink.attachEvent("onclick", nextMo);
					}
				}
			]]></script><br>
			
			<p>Our final step is to create a listener to call the event listener function above. This one will execute as soon as the page finishes loading. 
			</p>
			
			<script type="syntaxhighlighter" class="brush: js"><![CDATA[
				/* Runs Event Listeners on page load */
				if (window.addEventListener)	{
					window.addEventListener("load", createEventListeners, false);
				} else if (window.attachEvent)	{
					window.attachEvent("onload", createEventListeners);
				}
			]]></script>
			
		</main>

<!-- Copyright info -->
		<footer>
			Copyright &copy; 2017 Katrina Ward
		</footer>
	</div>
	
<script src="modernizr.custom.05819.js"></script>
<script type="text/javascript"src="shCore.js"></script>
<script type="text/javascript" src="shBrushJScript.js"></script>
<script type="text/javascript">SyntaxHighlighter.all()</script>

	
</body>
</html>
